<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Analizador y Visualizador Interactivo de Expresiones Lógicas</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            padding: 20px;
        }
        #expresionLogica {
            width: 300px;
            padding: 5px;
            margin-bottom: 10px;
        }
        .teclado button {
            margin: 5px;
            width: 50px;
        }
        .arbol, .ramas {
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .nodo {
            border: 1px solid black;
            padding: 5px;
            margin: 5px;
            display: inline-block;
        }
        .error {
            color: red;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>Analizador y Visualizador Interactivo de Expresiones Lógicas</h1>
    <input type="text" id="expresionLogica" placeholder="Ingrese su expresión lógica, p.ej. p ∧ (q ∨ r)">
    <button onclick="analizarYVisualizar()">Analizar y Visualizar</button>
    <div class="teclado">
        <button onclick="insertar('p')">p</button>
        <button onclick="insertar('q')">q</button>
        <button onclick="insertar('r')">r</button>
        <button onclick="insertar(' ∧ ')">∧</button>
        <button onclick="insertar(' ∨ ')">∨</button>
        <button onclick="insertar(' ¬')">¬</button>
        <button onclick="insertar(' (')">(</button>
        <button onclick="insertar(' )')">)</button>
    </div>
    <div id="visualizacionArbol"></div>

    <script>
        // Inserción de caracteres en el campo de texto
        function insertar(caracter) {
            const input = document.getElementById('expresionLogica');
            input.value += caracter;
            input.focus();
        }

        // Definición de la clase Nodo
        class Nodo {
            constructor(valor, izquierda = null, derecha = null) {
                this.valor = valor;
                this.izquierda = izquierda;
                this.derecha = derecha;
            }
        }

        // Analizar la expresión lógica (implementación simplificada)
        function analizarExpresion(expresion) {
            // Lógica para analizar la expresión y construir el árbol
        }

        // Visualizar el árbol de análisis
        function visualizarArbol(nodo, padreId = '') {
            // Lógica para crear la estructura HTML del árbol
        }

        // Actualizar el valor de un nodo y reconstruir el árbol
        function actualizarNodo(nodo, nuevoValor) {
            nodo.valor = nuevoValor;
            // Reconstruir el árbol si es necesario
        }

        // Editar un nodo del árbol
        function editarNodo(nodoId, nodo) {
            // Lógica para editar un nodo y actualizar el árbol
        }

        // Función para analizar y visualizar la expresión lógica
        function analizarYVisualizar() {
            const expresion = document.getElementById('expresionLogica').value;
            try {
                const arbol = analizarExpresion(expresion);
                const visualizacion = visualizarArbol(arbol);
                document.getElementById('visualizacionArbol').innerHTML = visualizacion;
            } catch (error) {
                document.getElementById('visualizacionArbol').innerHTML = `<p class="error">Error: ${error.message}</p>`;
            }
        }

        // Implementación de las funciones adicionales para interactividad
      class Nodo {
    constructor(valor, izquierda = null, derecha = null) {
        this.valor = valor;
        this.izquierda = izquierda;
        this.derecha = derecha;
    }
}

function actualizarNodo(nodo, nuevoValor) {
    nodo.valor = nuevoValor;
    // Aquí podrías añadir más lógica si la actualización del nodo afecta a otros nodos
}

function crearElementoNodo(nodo, padreId) {
    let nodoElemento = document.createElement('div');
    nodoElemento.className = 'nodo';
    nodoElemento.id = 'nodo-' + padreId;
    nodoElemento.innerText = nodo.valor;
    
    nodoElemento.onclick = function() {
        editarNodo(nodoElemento.id, nodo);
    };

    return nodoElemento;
}

function visualizarArbol(nodo, padreId = '') {
    if (!nodo) return;

    let nodoElemento = crearElementoNodo(nodo, padreId);
    let arbolElemento = document.createElement('div');
    arbolElemento.className = 'arbol';
    arbolElemento.appendChild(nodoElemento);

    let ramasElemento = document.createElement('div');
    ramasElemento.className = 'ramas';

    let ramaIzquierda = visualizarArbol(nodo.izquierda, nodoElemento.id + '-izq');
    let ramaDerecha = visualizarArbol(nodo.derecha, nodoElemento.id + '-der');

    if (ramaIzquierda) ramasElemento.appendChild(ramaIzquierda);
    if (ramaDerecha) ramasElemento.appendChild(ramaDerecha);

    arbolElemento.appendChild(ramasElemento);

    return arbolElemento;
}

        // como expandir/colapsar nodos y editar directamente en la visualización.
      function editarNodo(nodoId, nodo) {
    let nodoElemento = document.getElementById(nodoId);
    let input = document.createElement('input');
    input.type = 'text';
    input.value = nodo.valor;
    input.onblur = function() {
        actualizarNodo(nodo, input.value);
        reconstruirYVisualizarArbol();
    };
    nodoElemento.innerHTML = '';
    nodoElemento.appendChild(input);
    input.focus();
}

function reconstruirYVisualizarArbol() {
    // Suponiendo que tienes una variable global `arbolRaiz` que representa el árbol
    let visualizacion = visualizarArbol(arbolRaiz);
    let contenedorArbol = document.getElementById('visualizacionArbol');
    contenedorArbol.innerHTML = '';
    contenedorArbol.appendChild(visualizacion);
}

    </script>
</body>
</html>
